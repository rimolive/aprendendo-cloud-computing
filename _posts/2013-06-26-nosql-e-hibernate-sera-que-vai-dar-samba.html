---
layout: post
title: NoSQL e Hibernate - Será que vai dar samba?
date: '2013-06-26T15:37:00.001-03:00'
author: Ricardo Martinelli Oliveira
tags:
- openshift
- mongodb
- hibernate
- nosql
modified_time: '2013-06-26T15:37:30.270-03:00'
thumbnail: http://4.bp.blogspot.com/-eyJvFUDP1rw/Ucsx5ooWSkI/AAAAAAAABb8/koFWOpk4JfE/s72-c/Screenshot+from+2013-06-26+15:21:34.png
blogger_id: tag:blogger.com,1999:blog-3438555562642680163.post-3326736537395333451
blogger_orig_url: http://aprendendo-cloud-computing.blogspot.com/2013/06/nosql-e-hibernate-sera-que-vai-dar-samba.html
---

NoSQL é a nova hype do momento, e todos estão aprendendo um pouco mais sobre novas formas de armazenamento. O termo foi introduzido por funcionários da Rackspace que queriam organizar um evento para discutir Bancos de Dados distribuídos. A idéia era discutir sobre Bancos de Dados que não se preocupam pelo ACID(Atomicidade, Consistência, Isolamento e Durabilidade).<br />Neste post, irei mostrar um pouco sobre adotar um banco de dados nosql em sua aplicação OpenShift utilizando java e um projeto recente da família Hibernate: o Hibernate OGM.<br /><br /><h3>OpenShift e NoSQL</h3><div>Desde o lançamento do OpenShift ele oferece três Bancos de Dados como repositório de dados para suas aplicações. Dentre eles, há 1 Banco de Dados NoSQL: O <a href="http://www.mongodb.org/">MongoDB</a>.</div><div>O MongoDB é um Banco de Dados NoSQL que utiliza o conceito de armazenamento baseado em documentos, ou seja, ele guarda as informações em coleções e expressando o dado em um formato JSON, ou como o próprio site do MongoDB diz: um armazenamento orientado a documentos.<br /><br /><h3>Rockmongo</h3></div><div>Assim como o MySQL e o PostgresSQL possuem interfaces de gerenciamento na web (o phpMyAdmin, por exemplo), o MongoDB também possui uma interface de gerenciamento: o Rockmongo.<br /><br /></div><h3>Hibernate OGM</h3>O Hibernate OGM (Object Grid Mapping) é um subprojeto do Hibernate que permite utilizar os mesmos conceitos do ORM(Object Relational Mapping) em Bancos de Dados NoSQL. Assim podemos mapear objetos e persisti-los no Banco de Dados sem precisar conhecer as formas de inserir esses dados.<br /><br /><h3>Como fazer deploy de uma aplicação Hibernate OGM no OpenShift?</h3><div>Para dar início, vamos criar uma aplicação Java no OpenShift e adicionar os cartridges MongoDB e Rockmongo:</div><blockquote class="tr_bq">$ rhc app create -t jbossas-7 -a nosql</blockquote><blockquote class="tr_bq">$ rhc app add-cartridge mongodb-2.2</blockquote><blockquote class="tr_bq">$ rhc app add-cartridge rockmongo-1.1</blockquote>Para esse post, eu utilizei o repositório do Github do próprio OpenShift com o projeto kitchensink (um pequeno CRUD muito utilizado para criar quickstarts para o JBoss) adaptado para utilizar o Hibernate OGM. Você pode encontrar o projeto em:<br /><br /><a href="https://github.com/openshift/openshift-ogm-quickstart">https://github.com/openshift/openshift-ogm-quickstart</a><br /><br />Agora, iremos adicionar a URL do repositório Github em nosso projeto OpenShift:<br /><br /><blockquote class="tr_bq">$ cd nosql<br />$ git remote add upstream -m master git://github.com/openshift/openshift-ogm-quickstart.git<br />$ git pull -s recursive -X theirs upstream master<br />$ git push</blockquote>Agora, basta acessar o endereço: http://nosql-${namespace}.rhcloud.com e ver a aplicação rodando:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-eyJvFUDP1rw/Ucsx5ooWSkI/AAAAAAAABb8/koFWOpk4JfE/s1600/Screenshot+from+2013-06-26+15:21:34.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="242" src="http://4.bp.blogspot.com/-eyJvFUDP1rw/Ucsx5ooWSkI/AAAAAAAABb8/koFWOpk4JfE/s400/Screenshot+from+2013-06-26+15:21:34.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Aplicação NoSQL com Hibernate OGM e MongoDB</td></tr></tbody></table>Como instalamos também o Rockmongo, você pode acessar utilizando o endereço http://nosql-${namespace}.rhcloud.com/rockmongo:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-nyb7pk47EVo/UcsyU7I39WI/AAAAAAAABcE/uhtPYD00_G0/s1600/Screenshot+from+2013-06-26+15:23:56.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="242" src="http://4.bp.blogspot.com/-nyb7pk47EVo/UcsyU7I39WI/AAAAAAAABcE/uhtPYD00_G0/s400/Screenshot+from+2013-06-26+15:23:56.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Aplicação Rockmongo</td></tr></tbody></table><blockquote class="tr_bq"></blockquote><h3>Considerações</h3><div><ul><li>Apesar de utilizar Hibernate EntityManager e com isso poder fazer uso de JPA, infelizmente ele não escaneia automaticamente pelas classes marcadas com&nbsp;@Entity. Você terá que referenciá-las no arquivo persistence.xml, senão não irá funcionar.</li><li>O projeto utilizado também faz uso de Hibernate Search para busca de dados, o que possibilita utilizar Full-Text Search em suas aplicações</li><li>Caso tenha feito o deploy do projeto mas não tenha encontrado as coleções da aplicação no Rockmongo, não se preocupe. O MongoDB (ou o Hibernate OGM, não entendi o processo nesse caso) só cria a coleção quando o primeiro registro é persistido.</li></ul><div>Bom pessoal, é isso. Eu tive um bocado de trabalho para fazer o build por conta dessas considerações e também por conta da build Maven. Quem precisar de ajuda, posta um comentário que eu procuro ajudar o mais rápido possível.</div></div><br />