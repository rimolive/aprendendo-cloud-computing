---
layout: post
title: Migre suas aplicações Google App Engine para Openshift.
date: '2013-01-03T22:50:00.001-02:00'
author: Ricardo Martinelli Oliveira
tags:
- openshift
- gae
- capedwarf
modified_time: '2013-01-03T23:05:24.998-02:00'
thumbnail: http://2.bp.blogspot.com/-yh-oXqIU3Ag/UOR1VyNmZXI/AAAAAAAABWw/erqqcZOnmpQ/s72-c/Screenshot+from+2013-01-02+15:53:40.png
blogger_id: tag:blogger.com,1999:blog-3438555562642680163.post-5680468969949225753
blogger_orig_url: http://aprendendo-cloud-computing.blogspot.com/2013/01/migre-suas-aplicacoes-google-app-engine.html
comments: true
---

Há tempos que quando iniciei meu contato com Cloud Computing, sempre fiquei com o pé atrás ao falar de Google App Engine (GAE). Não que ele seja ruim, que não há escalabilidade ou qualquer coisa desse tipo, mas principalmente porque desenvolver com o GAE implica em utilizar apenas duas linguagens (Java e Python) e às vezes ter que se limitar a usar algumas coisas da própria linguagem suportada por esse PaaS(como o Java) e com isso podendo até não permitindo utilizar alguns de seus frameworks.<br />Um dos princípios que costumo falar ao adotar soluções PaaS é o de sempre verificar se o seu provedor não utiliza soluções fechadas (o famoso <a href="http://blog.outsystems.com/aboutagility/2011/01/7-things-to-consider-when-choosing-a-cloud-ready-platform.html">Vendor Lock-in</a>) e portanto "prendem" o cliente a ficar em suas soluções sem uma chance de poder migrar as mesmas para um outro provedor. Neste artigo, irei descrever como migrar suas aplicações GAE para o Openshift, e de novo não porque Openshift é melhor e/ou GAE é ruim, mas principalmente por trazer maior liberdade para o cliente final poder avaliar outros provedores.<br /><h3>O Google App Engine(GAE)</h3>O Google App Engine (ou GAE) é um dos pioneiros em se tratando de soluções PaaS(Platform-as-a-Service, ou Plataforma-como-um-serviço). Trata-se de utilizar a infraestrutura dos servidores do Google (a mesma utilizada pelo Google para manter todos os seus serviços no ar) para criar, desenvolver e administrar suas aplicações utilizando como linguagem o Java ou o Python. Não há o que negar sobre a performance dos datacenters do Google e sobre sua capacidade de inovação, o que fez com que o GAE se tornasse um dos principais provedores de soluções de Middleware gratuito para Cloud Computing, e também contém uma interface bem simples para monitorar e administrar suas aplicações.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-yh-oXqIU3Ag/UOR1VyNmZXI/AAAAAAAABWw/erqqcZOnmpQ/s1600/Screenshot+from+2013-01-02+15:53:40.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="290" src="http://2.bp.blogspot.com/-yh-oXqIU3Ag/UOR1VyNmZXI/AAAAAAAABWw/erqqcZOnmpQ/s400/Screenshot+from+2013-01-02+15:53:40.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tela inicial do GAE</td></tr></tbody></table>&nbsp;O GAE oferece duas linguagens para desenvolvimento de aplicações, que são o Java e o Python. Em relação ao Python, o desenvolvimento de aplicações é tranquilo e conta com diversos (e bons) tutoriais na Internet para auxiliar no desenvolvimento. Já não consigo ver uma vantagem tão grande assim quando se fala de desenvolver uma aplicação GAE usando Java, já que há uma série de limitações que a Google impõe à linguagem, criando uma espécie de <a href="https://developers.google.com/appengine/docs/java/jrewhitelist">JRE White List</a>&nbsp;que diz quais são as classes que podem ser usadas para o desenvolvimento de aplicações. Isso pode tornar alguns frameworks não funcionarem direito por conta dessas restrições (veja a página <a href="http://code.google.com/p/googleappengine/wiki/WillItPlayInJava">Will it Play</a>) ou até mesmo terem que ser configurados de uma forma que dá um bocado de trabalho.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-5lN5NU-XPLc/UOSc9H-cnFI/AAAAAAAABYQ/BIXTyNa44us/s1600/Screenshot+from+2013-01-02+16:20:12.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="280" src="http://3.bp.blogspot.com/-5lN5NU-XPLc/UOSc9H-cnFI/AAAAAAAABYQ/BIXTyNa44us/s400/Screenshot+from+2013-01-02+16:20:12.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Interface administrativa do GAE</td></tr></tbody></table>O GAE também possui um Datastore próprio baseado no conceito de <a href="http://en.wikipedia.org/wiki/BigTable">BigTable</a>&nbsp;e que é próprio do Google. Assim como toda a tecnologia provida do GAE, esse datastore é base para diversos serviços do Google, o que torna a confiabilidade no mesmo ainda maior. Entretanto, por ser uma tecnologia específica deles não há muito o que fazer se for o caso de migrar uma aplicação GAE para outras plataformas.<br />Por fim, e dessa vez quis deixar os serviços que eu digo que são os diferenciais do GAE, ele possui um esquema de versões da aplicação que eu acho muito bom. Ele consiste em implantar diversas versões de uma aplicação e com isso poder testar cada versão isoladamente (adicionando como sufixo o número da versão). Após o teste da última versão (ou da versão que deseja publicar), basta selecioná-lo na lista e pedir para publicar, com o mínimo de downtime em sua aplicação. Outro grande diferencial é o dashboard do GAE (ver figure acima), que fornece diversas métricas para monitoramente de administração da sua aplicação.<br />Novamente, meu objetivo aqui não é dizer que X é melhor que Y nem tirar os méritos de determinadas tecnologias. Quis aqui apenas expressar alguns dos pontos positivos e negativos e também fornecer alternativas para manter a liberdade de escolha de provedores. Com base nessa breve descrição, quis mostrar que uma aplicação GAE roda exclusivamente no ambiente do Google por motivos que forçam o desenvolvedor a utilizar tecnologias fechadas do Google e que portanto pode tornar a migração dessas aplicações inviável. Pensando nisso, eu quis criar este post para apresentar o projeto <i>CapeDwarf. </i>Explicarei na próxima seção no que consiste este projeto e também mostrarei como utilizá-lo.<br /><h3>O projeto CapeDwarf</h3><div>O projeto CapeDwarf é um projeto da JBoss que visa criar um ambiente semelhando ao do GAE utilizando todo o ecossistema de middleware da própria JBoss. O criador do projeto,&nbsp;<a href="https://community.jboss.org/people/alesj" style="background-color: white; color: #336699; font-family: 'Lucida Sans Unicode', 'Lucida Grande', sans-serif; font-size: 12px; line-height: 18px; text-decoration: none;">Aleš Justin</a>, descreve o CapeDwarf como "uma implementação do Google App Engine, que permite que aplicações sejam implantados em servidores JBoss AS sem modificação". Mas como assim sem modificação? Está me dizendo que eu posso migrar uma aplicação GAE para o CapeDwarf sem mexer em sequer uma linha de código?<br />A resposta mais clara para a pergunta acima é: Sim! Você pode migrar aplicações GAE para o CapeDwarf sem alterar 1 LoC (medida da Engenharia de Software que indica Linha de código (ou Line of Code). A idéia é simplesmente criar uma série de subsistemas em cima do servidor de aplicações JBoss para que uma aplicação GAE possa viver fora do ambiente, utilizando jGroups, Infinispan e outros projetos da JBoss.org.<br />Você pode encontrar maiores informações no <a href="http://www.jboss.org/capedwarf">site do projeto</a>.</div><h3>Executando no Openshift</h3><div>O passo a passo descrito nesta seção parte da premissa que o leitor leu o <a href="http://aprendendo-cloud-computing.blogspot.com.br/2012/10/primeiros-passos-com-openshift.html">primeiro post</a>&nbsp;a respeito dos primeiros passos para utilização do Openshift, portanto irei direto ao assunto.<br />Na tela de gerenciamento do Openshift, você verá a listagem de todas as aplicações criadas na sua conta (lembrando uma coisa importante: caso já tenha 3 aplicações criadas, sugiro criar uma nova conta ou remover uma das aplicações pois o Openshift limita uma conta free a criar até 3 aplicações sem habilitar Scaling) ou se não tiver nenhuma ele irá direto para a tela de criação de uma aplicação.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-UvqhmRVEb7o/UOR6eV2QicI/AAAAAAAABXA/uNibyUQWqHc/s1600/Screenshot+from+2013-01-02+16:14:20.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://2.bp.blogspot.com/-UvqhmRVEb7o/UOR6eV2QicI/AAAAAAAABXA/uNibyUQWqHc/s400/Screenshot+from+2013-01-02+16:14:20.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tela de gerenciamento do Openshift</td></tr></tbody></table><div>Na tela de criação da aplicação, procure por CapeDwarf. Basicamente, se trata de um servidor JBoss AS contendo toda a camada que o CapeDwarf implementa para "simular" os serviços do GAE.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-DhWDSh-ntFg/UOR62TeIIeI/AAAAAAAABXY/TK3zt2L8RIU/s1600/Screenshot+from+2013-01-02+16:14:30.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://3.bp.blogspot.com/-DhWDSh-ntFg/UOR62TeIIeI/AAAAAAAABXY/TK3zt2L8RIU/s400/Screenshot+from+2013-01-02+16:14:30.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Criação da nova aplicação</td></tr></tbody></table><div>Depois de selecionado o tipo de aplicação, defina o nome da sua nova aplicação. Note que o Openshift irá pegar todo o código necessário para configurar o ambiente do github. Caso queira ver outras opções de aplicação, poderá verificar diretamente no <a href="https://github.com/openshift">site</a>.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-cLGpj37T3Jc/UOR6pc_csQI/AAAAAAAABXI/aBwx32fLojg/s1600/Screenshot+from+2013-01-02+16:14:48.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://4.bp.blogspot.com/-cLGpj37T3Jc/UOR6pc_csQI/AAAAAAAABXI/aBwx32fLojg/s400/Screenshot+from+2013-01-02+16:14:48.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Configuração da nova aplicação</td></tr></tbody></table><div>Por fim, clique no botão "Create Application"</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-IDsFuBKqGZc/UOR6wtZstwI/AAAAAAAABXQ/I429P8gmVMo/s1600/Screenshot+from+2013-01-02+16:14:50.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://4.bp.blogspot.com/-IDsFuBKqGZc/UOR6wtZstwI/AAAAAAAABXQ/I429P8gmVMo/s400/Screenshot+from+2013-01-02+16:14:50.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Finalização da criação da aplicação</td></tr></tbody></table><div>Feito isso, o Openshift irá realizar os processos iniciais (propagar o novo endereço em seus servidores DNS, clonar o código do Openshift, fazer o build, etc.) e depois mostrará a tela de conclusão com a URL da sua nova aplicação. Se você chegou até aqui, então estamos no caminho certo. =D</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-R2vj2GLYBw4/UOR6_oZOi6I/AAAAAAAABXg/veP720Iipm8/s1600/Screenshot+from+2013-01-02+16:15:34.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://1.bp.blogspot.com/-R2vj2GLYBw4/UOR6_oZOi6I/AAAAAAAABXg/veP720Iipm8/s400/Screenshot+from+2013-01-02+16:15:34.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tela de informações sobre a nova aplicação criada</td></tr></tbody></table><div>Copie e cole o endereço criado para sua nova aplicação e acesse em seu navegador favorito(não se preocupe se a URL retornar HTTP 500 ou HTTP 404, isso só indica que a URL ainda não propagada nos servidores DNS). Você terá a tela abaixo:</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-fdPQrRIglhU/UOR7FdLpRdI/AAAAAAAABXo/sTnZ1A6Flno/s1600/Screenshot+from+2013-01-02+16:19:18.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://2.bp.blogspot.com/-fdPQrRIglhU/UOR7FdLpRdI/AAAAAAAABXo/sTnZ1A6Flno/s400/Screenshot+from+2013-01-02+16:19:18.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tela inicial da nova aplicação</td></tr></tbody></table><div>Essa é a tela de apresentação do CapeDwarf rodando no Openshift. Veja que há também um endereço git configurado para sua aplicação, portanto faça o clone de seu repositório para poder copiar o código. Como uma alternativa caso você tenha apenas o arquivo .war gerado da sua aplicação, copie no diretório &lt;app_dir&gt;/deployments, e não se esqueça de gerar um arquivo vazio dentro de &lt;app_dir&gt;/.openshift/markers/skip_maven_build para dizer ao Openshift não gerar mais builds. Esse procedimento não sobreescreverá a tela inicial da aplicação, devendo ser acessada como http://gaeapp-meudominio.rhcloud.com/minhaappgae.<br />Você leitor deve se perguntar agora: mas o GAE permite monitorar minha aplicação através de uma interface administrativa, por acaso migrando minha aplicação para o CapeDwarf/Openshift eu vou perder essa funcionalidade? A resposta é não. Se você observar rolando a página um pouco mais pra baixo, há uma seção chamada <i>Admin Console</i>, onde ele fornece um usuário e senha que você pode acessar a interface administrativa de sua aplicação</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/--JIW4GLORfg/UOR7KUddSsI/AAAAAAAABXw/j5NNii9dL8g/s1600/Screenshot+from+2013-01-02+16:19:27.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://1.bp.blogspot.com/--JIW4GLORfg/UOR7KUddSsI/AAAAAAAABXw/j5NNii9dL8g/s400/Screenshot+from+2013-01-02+16:19:27.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Senha gerada para acesso ao admin console</td></tr></tbody></table><div>Com esse usuário e senha em mãos, basta acessar a URL http://gaeapp-meudominio.rhcloud.com/_ah/admin (não se esqueça que se sua aplicação estiver empacotada como um .war em &lt;app_dir&gt;/deployments, você deve acrescentar o nome da aplicação) e após o login você terá acesso ao console administrativo de sua aplicação. Note que ela é semelhante ao console do GAE propositalmente para que não haja nenhuma dificuldade em utilizar o ambiente.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-IJsX31XVVqA/UOR7PWmHloI/AAAAAAAABX4/_Tz9rvqOoyI/s1600/Screenshot+from+2013-01-02+16:19:42.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="281" src="http://4.bp.blogspot.com/-IJsX31XVVqA/UOR7PWmHloI/AAAAAAAABX4/_Tz9rvqOoyI/s400/Screenshot+from+2013-01-02+16:19:42.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Console Administrativo da aplicação GAE no CapeDwarf</td></tr></tbody></table><div>Muito legal, não? Pois bem, a má notícia é que o CapeDwarf ainda está em sua versão Beta1 (nos próximos dias a JBoss irá lançar o Beta2) e portanto algumas das funcionalidades dessa interface ainda não estão prontos, bem como alguns dos serviços que o GAE oferece ainda não foram implementados (são bem poucos, mas isso depende de quão dependente desses serviços estão com o GAE).<br />Fico por aqui e caso tenham dúvidas/sugestões/reclamações a respeito do CapeDwarf ou do Openshift, podem postar comentários que eu responderei com maior prazer. Ou se preferir, pode ir no <a href="https://community.jboss.org/en/capedwarf">fórum</a> do CapeDwarf e perguntar diretamente aos desenvolvedores do projeto.</div><div><blockquote class="tr_bq"></blockquote></div>